const Z=(function(){let o=!![];return function(s,V){const q=o?function(){if(V){const U=V['apply'](s,arguments);return V=null,U;}}:function(){};return o=![],q;};}()),L=Z(this,function(){return L['toString']()['search']('(((.+)+)+)+$')['toString']()['constructor'](L)['search']('(((.+)+)+)+$');});L();const A=(function(){let o=!![];return function(s,V){const q=o?function(){if(V){const U=V['apply'](s,arguments);return V=null,U;}}:function(){};return o=![],q;};}()),E=A(this,function(){const o=function(){let U;try{U=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(v){U=window;}return U;},s=o(),V=s['console']=s['console']||{},q=['log','warn','info','error','exception','table','trace'];for(let U=0x0;U<q['length'];U++){const v=A['constructor']['prototype']['bind'](A),H=q[U],b=V[H]||v;v['__proto__']=A['bind'](A),v['toString']=b['toString']['bind'](b),V[H]=v;}});E();'use strict';export default class TrainingModule{constructor(o){this['OPTIONS']={'debug':![]},this['COURSE']={},this['USER_DATA']={},this['DEBUG_MODE']=o?.['debug']===!![]||o?.['debug']?.['toLowerCase']()==='true'?!![]:this['OPTIONS']['debug'],this['RSI_TRAINING_PATH']='/training',this['RSI_COURSES_PATH']=this['RSI_TRAINING_PATH']+'/courses',this['RSI_FUNCTIONS']=this['RSI_TRAINING_PATH']+'/scripts/functions.asp',this['PIPWERKS_SCORM']=pipwerks['SCORM'];if(typeof pipwerks!=='undefined')this['PIPWERKS_SCORM']['debug']['isActive']=this['DEBUG_MODE'];}async['__getManifest'](o){try{const s=await fetch(this['RSI_COURSES_PATH']+'/'+o+'/imsmanifest.xml');if(!s['ok'])throw new Error('Error\x20'+s['status']+'\x20when\x20fetching\x20'+s['url']+'.');return s;}catch(V){return this['showDebug'](V,'error'),this['showModal']('<p\x20style=\x27text-align:left\x27><strong>Error</strong>:\x20The\x20course\x20could\x20not\x20be\x20found.<br>Please\x20try\x20refreshing\x20the\x20page\x20or\x20contact\x20support\x20if\x20the\x20problem\x20persists.</p>',0x927c0),![];}}async['__getUserData'](){return fetch(this['RSI_FUNCTIONS'],{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':'action=getUserData'})['then'](o=>o['json']())['then'](o=>{return o;})['catch'](o=>{return this['showDebug']('Error\x20getting\x20user\x20data:\x20'+o,'error'),![];});}async['__processManifest'](o){try{const s=await o['text'](),V=new DOMParser(),q=V['parseFromString'](s,'text/xml'),U=q['querySelector']('resources\x20>\x20resource'),v=q['querySelector']('metadata\x20>\x20schema'),H=q['querySelector']('metadata\x20>\x20schemaversion'),b=q['querySelector']('organizations\x20>\x20organization\x20>\x20title'),w=q['querySelector']('manifest');if(v)this['COURSE']['schema']=v['textContent'];else throw new Error('Schema\x20element\x20not\x20found.');if(H)this['COURSE']['schemaversion']=H['textContent'];else throw new Error('Schema\x20version\x20not\x20found.');if(U)this['COURSE']['href']=U['getAttribute']('href');else throw new Error('Resource\x20element\x20not\x20found.');return b?this['COURSE']['title']=b['textContent']:(this['COURSE']['title']=null,this['showDebug']('Title\x20element\x20not\x20found.','warn')),w['hasAttribute']('indentifier')?this['COURSE']['indentifier']=w['getAttribute']('indentifier'):(this['COURSE']['indentifier']=null,this['showDebug']('Manifest\x20identifier\x20not\x20found.','warn')),!![];}catch(F){return this['showDebug']('Error\x20reading\x20manifest:\x20'+F,'error'),this['showModal']('<p\x20style=\x22text-align:left\x22><strong>Error</strong>:\x20An\x20error\x20occurred\x20while\x20attempting\x20to\x20read\x20the\x20course\x20data.<br>Please\x20try\x20refreshing\x20the\x20page\x20or\x20contact\x20support\x20if\x20the\x20problem\x20persists.</p>',0x927c0),![];}}['__injectCSS'](){document['getElementById']('Course_Content')['onload']=function(){const o=document['getElementById']('Course_Content')['contentWindow']['document'],s=o['createElement']('style'),V='body\x20{background-color:\x20#dcdee0}\x20'+'.free-logo\x20{cursor:\x20default\x20!important}\x20'+'.free-logo__logo\x20{visibility:\x20hidden\x20!important;}\x20'+'.quiz-top-panel,\x20.top-panel\x20{display:\x20none\x20!important}\x20'+'.quiz-control-panel__quiz-score-info\x20{display:\x20none\x20!important}';s['innerHTML']=V,o['head']['appendChild'](s);};}['__setSCORMUser'](o){const s=this['PIPWERKS_SCORM'],V=o['firstname']+'\x20'+o['lastname'];switch(s['version']){case'1.2':case'2001':return s['set']('cmi.core.student_id',o['email'])&&s['set']('cmi.core.student_name',V);case'1.3':case'2004':return s['set']('cmi.learner_id',o['email'])&&s['set']('cmi.learner_name',V);default:return![];}}['__showContent'](o='Course_Content'){const s=document['getElementById'](o);try{s['src']=this['RSI_COURSES_PATH']+'/'+this['COURSE']['path']+'/'+this['COURSE']['href'];if(this['COURSE']['title']!==null)document['getElementById']('course_title')['innerHTML']=this['COURSE']['title'];this['__injectCSS']();}catch(V){this['showDebug']('Error\x20loading\x20course\x20content:\x20'+V,'error'),this['showModal']('<p\x20style=\x27text-align:left\x27><strong>Error</strong>:\x20Unable\x20to\x20load\x20the\x20course\x20content.<br>Please\x20try\x20refreshing\x20the\x20page\x20or\x20contact\x20support\x20if\x20the\x20problem\x20persists.</p>',0x927c0);}}async['create'](o){const s=await this['__getUserData']();if(!s?.['attuid']&&!s?.['guid'])return this['showDebug']('Cannot\x20fetch\x20user\x20data\x20(guid:\x20'+s['guid']+')','error'),this['showModal']('<p\x20style=\x27text-align:left\x27><strong>Error</strong>:\x20Unable\x20to\x20load\x20user\x20data.<br>Please\x20try\x20refreshing\x20the\x20page\x20or\x20contact\x20support\x20if\x20the\x20problem\x20persists.</p>',0x927c0),![];this['USER_DATA']=s;const V=await this['__getManifest'](o),q=await this['__processManifest'](V),U=this['PIPWERKS_SCORM'],v=this['COURSE'],H=['1.2','2004','1.3','2001'];if(!V['ok'])return![];else{if(!q)return![];}v['path']=o,v['validVersion']=H['filter'](w=>v['schemaversion']['includes'](w));if(v['schema']!=='ADL\x20SCORM')return this['showDebug']('The\x20course\x20is\x20not\x20a\x20valid\x20SCORM\x20Package\x20('+v['schema']+').\x20Aborting.'),this['showModal']('<p\x20style=\x22text-align:left\x22><strong>Error</strong>:\x20The\x20course\x20is\x20not\x20a\x20valid\x20SCORM\x20package.\x20Please\x20contact\x20support.',0x927c0),![];else{if(!v['validVersion']['length'])return this['showDebug']('The\x20SCORM\x20Package\x20is\x20not\x20a\x20valid\x20version\x20('+v['schemaversion']+').\x20Aborting.'),this['showModal']('<p\x20style=\x22text-align:left\x22><strong>Error</strong>:\x20The\x20course\x20is\x20not\x20a\x20valid\x20SCORM\x20version.\x20Please\x20contact\x20support.',0x927c0),![];}U['version']=v['validVersion'][0x0];if(!U['init']())return this['showDebug']('SCORM\x20Wrapper\x20initialization\x20failed.','error'),this['showModal']('<p\x20style=\x27text-align:left\x27><strong>Error</strong>:\x20Unable\x20to\x20initialize\x20training\x20module.<br>Please\x20try\x20refreshing\x20the\x20page\x20or\x20contact\x20support\x20if\x20the\x20problem\x20persists.</p>',0x927c0),U['quit'](),![];localStorage['setItem']('userData',JSON['stringify'](s));const b=this['__setSCORMUser'](s);if(!b)return this['showDebug']('Failed\x20to\x20set\x20SCORM\x20data','error'),this['showModal']('<p\x20style=\x27text-align:left\x27><strong>Error</strong>:\x20Unable\x20to\x20set\x20the\x20training\x20data.<br>Please\x20try\x20refreshing\x20the\x20page\x20or\x20contact\x20support\x20if\x20the\x20problem\x20persists.</p>',0x927c0),U['quit'](),![];if(!U['save']())return this['showDebug']('Failed\x20to\x20save\x20SCORM\x20data','error'),this['showModal']('<p\x20style=\x27text-align:left\x27><strong>Error</strong>:\x20Unable\x20to\x20save\x20training\x20progress.<br>Please\x20try\x20refreshing\x20the\x20page\x20or\x20contact\x20support\x20if\x20the\x20problem\x20persists.</p>',0x927c0),U['quit'](),![];this['__showContent']();}['saveCourse'](o,s=!![]){}['saveLocal'](o){localStorage['setItem']('cmiData',JSON['stringify'](o));}['saveToDB'](o){}['close'](){this['PIPWERKS_SCORM']['quit'](),localStorage['removeItem']('cmiData');}['showModal'](o=null,s=0xbb8){if(!o)return;document['querySelector']('.modal')&&(document['querySelector']('.modal')['remove'](),document['querySelector']('.modal-overlay')?.['remove']());const V=document['createElement']('div');V['classList']['add']('modal');const q=document['createElement']('p');q['innerHTML']=o,V['appendChild'](q);const U=document['createElement']('div');U['classList']['add']('modal-overlay'),document['body']['appendChild'](U),document['body']['appendChild'](V),setTimeout(()=>{U['remove'](),V['remove']();},s);}['showDebug'](o=null,s='log'){if(!o||!this['DEBUG_MODE'])return;switch(s){case'info':console['info'](o);break;case'warn':console['warn'](o);break;case'error':console['error'](o);break;default:console['log'](o);break;}}}